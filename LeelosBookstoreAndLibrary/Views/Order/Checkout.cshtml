@model LeelosBookstoreAndLibrary.Models.CheckoutViewModel

@{
    ViewBag.Title = "Checkout";
}

<h2>Checkout</h2>

@if (TempData["Message"] != null)
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />

    <style>
        /* Custom style to make toastr success green */
        .toast-success {
            background-color: #28a745 !important; /* Bootstrap green */
        }
    </style>

    <script>
        $(document).ready(function () {
            toastr.success('@TempData["Message"]', 'Success', { timeOut: 5000 });
        });
    </script>
}

@if (TempData["ErrorMessage"] != null)
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />

    <script>
        $(document).ready(function () {
            toastr.error('@TempData["ErrorMessage"]', 'Error', { timeOut: 5000 });
        });
    </script>
}


@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger">
        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
        {
            <p>@error.ErrorMessage</p>
        }
    </div>
}


<!-- User Info -->
<h3>User Information</h3>
<p>Name: @Model.User.FirstName @Model.User.LastName</p>
<p>Email: @Model.User.Email</p>

<!-- Shipping Info -->
<h3>Shipping Information</h3>
<p>Address: @Model.ShippingInfo.Address</p>
<p>City: @Model.ShippingInfo.City</p>
<p>Governorate: @Model.ShippingInfo.Governorate</p>
<p>ZIP Code: @Model.ShippingInfo.ZipCode</p>
<p>Country: @Model.ShippingInfo.Country</p>
<p>Phone Number: @Model.ShippingInfo.PhoneNumber</p>

<!-- Payment Information -->
<h3>Payment Information</h3>
<p>Payment Method: @Model.PaymentMethod</p>
@*<p>Card Number: @Model.CardNumber</p>*@ <!-- Displaying card number should be handled securely! -->
<!-- Order Details -->
<h3>Order Details</h3>
<table class="table">
    <thead>
        <tr>
            <th>Book Title</th>
            <th>Quantity</th>
            <th>Price</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.cartItems)
        {
            <tr>
                <td>@item.Book.Title</td>
                <td>@item.Quantity</td>
                <td>@item.Price</td>
            </tr>
        }
    </tbody>
</table>
<p>Total Price: @Model.TotalPrice</p>

<!-- Confirm Button -->
<form method="post" action="@Url.Action("ConfirmOrder", "Order")">
    <input type="hidden" name="price" value="@Model.TotalPrice" />
    <button type="submit" class="btn btn-primary">Confirm Order</button>
</form>

